---
title: "Breastfeeding Indicators"
author: "Nicholus Tint Zaw" 
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{bf_indicatros}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  message =  FALSE, 
  warning = FALSE, 
  error = FALSE, 
  collapse = TRUE,
  comment = "#>"
)
```


# Introduction 

In new WHO 2021 IYCF indicator guideline, there are 7 indicators related to breastfeeding practices list as below. In this article, we are going to demonstrate how the `riycf`` package can apply for calculation fo those indicators in steps-by-steps approach. 

1. Ever Breastfeed (EvBF) 
2. Early Initiation Of Breastfeeding (EIBF) 
3. Exclusive Breastfeed For The First Two Days After Birth (BEF2D) 
4. Exclusive Breastfeeding Under Six Months (EBF)
5. Mixed Milk Feeding Under Six Months (MixMF) 
6. Continious Breastfeeding 12-23 Months (CBF) 
7. Bootle Feeding 0-23 Months (BoF) 


# Dataset Set-up 

Firstly, load the required libraries for data analysis work. I will use `riycf` package for the IYCF indicator generation work. 

```{r setup}
library(riycf)
```


For this guideline demonstration, I will use the sample dataset provided by the CARE Myanmar team on IYCF modules. A detailed description of the variable's name and variable labels are mentioned in the documentation. Use the following syntax to check for the dataset description. 

```{r df_load}
?iycfData

df <- iycfData
head(df[1:5])

```

This dataset contains 359 observations and 46 variables, and all variables were organized based on the WHO IYCF sample questionnaire. We tried to mentioned explicitly on matching function inputs parameters and questions numbers from the WHO IYCF sample question. If your dataset did not have the exact variables as the WHO sample one, please apply the most relevance one in the respective input parameter. 


# Breastfeeding Indicator Calculation 

## Ever Breastfeed (EvBF) 

According to the WHO definition, this is the proportion of under 2 years old children (< 24 months) who were ever breastfeed. Therefore, this indicator only account for under 2 yours old children and the children outside of this age range should not include in the indicator calculation. To get this indicator, I will going to use the `get_evbf` function as following. We need two input parameters to calculate this indicators; child age in month and child was ever breastfed or not (`Questions 1` from WHO IYCF questionnaires). 


```{r}
df$evbf <- get_evbf(q4 = df$child_bf, 
                    age = df$calc_age_months)
table(df$evbf)

```


We can also check this is correct or not using some manual data checking. There are 153 under 2 years old children available in this sample dataset. 

```{r}
length(which(df$calc_age_months < 24))
```
Among them, 108 were breastfeeding and the other 45 didn't. Therefore, the `get_evbf` function yield the same result as out manual check and you can go ahead and use it for reporting purpose. 

```{r}
length(which(df$calc_age_months < 24 & df$child_bfyest == 1))
length(which(df$calc_age_months < 24 & df$child_bfyest == 0))
```

## Early Initiation Of Breastfeeding (EIBF) 

This early initiation of breastfeeding only account for the children under 2 years old who were put to the breast within one hour of birth. We need three parameters to use `get_eibf` function to calculate this indicator. Because, according to the indicator definition, it allowed for the two conditions to determine as EIBF; put immediately to the breast or within one hour. Although, this information is asked by one question (`Question 2` from the WHO IYCF sample questionnaires), the response were normally record into three categories; one for immediately, one for recording hours and the other for the days. In this function, we will use the first two variables related to WHO question number 2 (immediately and hours record). Look at below for how to use this function. 

```{r}
df$eibf <- get_eibf(age = df$calc_age_months, 
                    q2 = df$child_eibf, 
                    q2_hour = df$child_eibf_hrs)
table(df$eibf)
```

Again, I ma going to make some manual checking on the result we got from `get_eibf` were correct or not. There were 102 children who meet the indicator definition conditions, the other 33 were not and 8 observation has missing information on the variable required for `q2` parameter. 

```{r}
length(which(df$calc_age_months < 24 & (df$child_eibf == 0 | df$child_eibf_hrs == 0)))
length(which(df$calc_age_months < 24 & df$child_eibf != 0 & df$child_eibf_hrs != 0))
length(which(df$calc_age_months < 24 & is.na(df$child_eibf)))
```

## Exclusive Breastfeed For The First Two Days After Birth (BEF2D) 

The indicator count for only under 2 years old children who were fed exclusively with breastmilk for the first two days after birth. Here, the exclusively breastfeeding condition was taken from the mother or caregiver self-reported answer, not like as calculation of standard exclusive breastfeeding indicator (which is going to calculate in following topic) calculation using the other different liquid and solid food recall variables. I will going to use `get_ebf2d` function for this one and it require two input parameters; age and `Question 3` from WHO IYCF sample questionnaires - which capture the information about the children were exclusively breastfeed in their first two days of life.  

```{r}
df$ebf2d <- get_ebf2d(q3 = df$bf_2days, 
                      age = df$calc_age_months)
table(df$ebf2d)
```
The manual check and our `get_ebf2d` function got the same result. 


```{r}
length(which(df$calc_age_months < 24 & df$bf_2days == 0))
length(which(df$calc_age_months < 24 & df$bf_2days == 1))
```


## Exclusive Breastfeeding Under Six Months (EBF)

Contract to previous breastfeeding indicator, this indicator need more than one step of calculation as it was demanded by the indicator definition. The EBF indicator only take consider for under 6 months children who were exclusive breastfeed yesterday. Which mean the child did not received any liquids or foods during the previous days, except breastmilk. To calculate this, we need four input parameters; age and the breastfeeding, and liquids and foods consumption from previous day. 

As a first step we need to calculate that liquid and food consumption status from the 24 hours diet recall from IYCF questionnaires. For this calculation, we can use the `get_dummy` function and included all the food items variables to get the respective liquid or solid (or simi-solid) food consumption status. If the child get any of the food items from the inputs foods items, the function will return as 1 and if not, 0.  

### Liquid consumption 

Below was the sample code to get the dummy variables to calculate the liquid consumption status. I used all the liquid recall questions as input parameters in this calculation (from `Question 6A` to `Question 6J` in WHO IYCF sample questionnaires). Whoever received any type of liquids from input parameters will score as 1 and did not, 0. 

Please note that, the input parameters for the `get_dummy` function is `list type`. We need to create a list of liquid variables we can to include in our analysis first, and then, apply that list in the `get_dummy` function to calculate the dummy variable which indicate the child received any type of liquid in the previous day or not. 

```{r}
liquid <- list(df$child_vitdrop, df$child_ors, df$child_water, df$child_juice, 
               df$child_broth, df$child_porridge, df$child_bms, df$child_milk, 
               df$child_mproduct, df$child_liquid)

df$liquid_food <- get_dummy(var_list = liquid)
table(df$liquid_food)
```

### Soild or semi-solid food consumption 

For solid and semi-food consumption status, I used all the variables from 24 hours solid (or semi-solid) food recall which is `Question 7A` to `Question 7R` in WHO IYCF questionnaires. If the child got any type of the food from this list, indicated as 1 and if didn't, 0. 

```{r}
solid <- list(df$child_rice, df$child_potatoes, df$child_pumpkin, 
              df$child_beans, df$child_leafyveg, df$child_mango, df$child_fruit, 
              df$child_organ, df$child_beef, df$child_fish, df$child_insects, 
              df$child_eggs, df$child_yogurt, df$child_fat, df$child_plam, 
              df$child_sweets, df$child_condiments)

df$solid_food <- get_dummy(var_list = solid)
table(df$solid_food)
```
### Calculation Of EBF indicator

Now, we got all the input parameters required for EBF indicator calculation. This `get_ebf` function will identify the children who exclusively breastfeed during the previous day which mean only got breastmilk and no liquid or solid food feedings. 


```{r}
df$ebf <- get_ebf(q4 = df$child_bfyest, 
                  age = df$calc_age_months, 
                  liquid_food = df$liquid_food, 
                  solid_food = df$solid_food)
table(df$ebf)
```

You can also cross-check the reuslt with below manual calculation syntax. The dataset has 40 under 6 months child, and among them only 15 were exclusively breastfeed. 

```{r}
length(which(df$calc_age_months < 6))
length(which(df$calc_age_months < 6 & df$child_bfyest == 1 & 
               df$liquid_food == 0 & df$solid_food == 0))
```

## Mixed Milk Feeding Under Six Months (MixMF) 

This indicator count for all under 6 months old children who were fed formula and/or animal milk in addition to breastmmilk during the previous day. We can use `get_mixmf` function to calculate this indicators and according to definition, we need four parameters; age, breastfeeding status, infant formula (`Question 6B`) and animal milk (`Question 6C`) consumption status from previous day. 


```{r}
df$mixmf <- get_mixmf(q4 = df$child_bfyest, 
                      age = df$calc_age_months, 
                      q6b = df$child_bms, 
                      q6c = df$child_milk)
table(df$mixmf)
```

Below was the manual calculation for checking `get_mixmf` function result. Out of 40 under 6 months old children, only 3 children get mixed milk feeding. 

```{r}
length(which(df$calc_age_months < 6 & df$child_bfyest == 1 & 
               (df$child_bms == 1 | df$child_milk ==  1)))
```


## Continious Breastfeeding 12-23 Months (CBF) 

This continuous breastfeeding indicator only account for the age range between 12-23 months. Children out of this age range will not consider in the indicator calculation. We will going to use `get_cbf` function and it required only two input parameters; child age and breastfeeding status from the previous day. 


```{r}
df$cbf <- get_cbf(q4 = df$child_bfyest, 
                  age = df$calc_age_months)
table(df$cbf)
```

Out of 64 children with 12-23 months years old, only 33 were continuously breastfed after one years of their age. Below was the manual calculation syntax and you will see that we got the same results as what `get_cbf` function did. 


```{r}
length(which(df$calc_age_months >= 12 & df$calc_age_months < 24))
length(which(df$calc_age_months >= 12 & df$calc_age_months < 24 & 
               df$child_bfyest == 1))
```


## Bootle Feeding 0-23 Months (BoF) 

This is the last indicator in the breastfeeding session and it count for the children (under 2 years old) who received the bottle feeding during the previous day. With `get_bof` function, we can calculate this indicators and its only require two input parameters; child age and bottle feeding status (`Question 5`). 


```{r}
df$bof <- get_bof(q5 = df$bf_bottle, 
                  age = df$calc_age_months)
table(df$bof)
```

Among 153 udner 2 years old children, only 24 were feed from bottle with a nipple during the previous day. 

```{r}
length(which(df$calc_age_months < 24 & df$bf_bottle == 1))
```

